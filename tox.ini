[tox]
env_list = py311, lint, type
requires = tox>=4
isolated_build = true

[testenv]
description = Run unit tests with pytest
deps =
    pytest
    pytest-cov
    flask
commands =
    pytest --cov=harborpi --cov-report=term-missing {posargs}

[testenv:lint]
description = Static analysis with ruff
skip_install = true
deps = ruff
commands = ruff check src tests

[testenv:type]
description = Type checking with mypy
deps =
    mypy
    types-requests
commands = mypy src/harborpi

[testenv:build]
description = Build and verify distribution
skip_install = true
deps =
    build
    twine
commands =
    python -m build
    twine check dist/*

[testenv:uv]
description = Use uv for dependency management
skip_install = true
allowlist_externals = uv
commands =
    uv sync